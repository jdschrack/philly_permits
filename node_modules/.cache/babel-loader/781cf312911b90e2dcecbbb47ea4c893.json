{"ast":null,"code":"import _slicedToArray from \"/Users/JDSCHRAC/projects/git/jdschrack/philly_permits/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"/Users/JDSCHRAC/projects/git/jdschrack/philly_permits/src/PermitTable.jsx\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport { useEffect, useState } from \"react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nvar PermitTable = function PermitTable() {\n  _s();\n\n  var _useState = useState(1000),\n      _useState2 = _slicedToArray(_useState, 2),\n      limit = _useState2[0],\n      setLimit = _useState2[1];\n\n  var _useState3 = useState(0),\n      _useState4 = _slicedToArray(_useState3, 2),\n      offset = _useState4[0],\n      setOffset = _useState4[1];\n\n  var _useState5 = useState(\"\"),\n      _useState6 = _slicedToArray(_useState5, 2),\n      rawQuery = _useState6[0],\n      setRawQuery = _useState6[1];\n\n  var nextPage = function nextPage() {\n    setOffset(offset + limit);\n    getData();\n  };\n\n  var prevPage = function prevPage() {\n    if (offset !== 0) {\n      setOffset(offset - limit);\n      getData();\n    }\n  };\n\n  var _useState7 = useState([]),\n      _useState8 = _slicedToArray(_useState7, 2),\n      columns = _useState8[0],\n      setColumns = _useState8[1];\n\n  var _useState9 = useState(0),\n      _useState10 = _slicedToArray(_useState9, 2),\n      recordCount = _useState10[0],\n      setRecordCount = _useState10[1];\n\n  var _useState11 = useState([]),\n      _useState12 = _slicedToArray(_useState11, 2),\n      data = _useState12[0],\n      setData = _useState12[1];\n\n  var _useState13 = useState(\"\"),\n      _useState14 = _slicedToArray(_useState13, 2),\n      csvData = _useState14[0],\n      setCsvData = _useState14[1];\n\n  var getData = function getData() {\n    var url = new URL(\"https://phl.carto.com/api/v2/sql\");\n    var query = \"select * from permits order by cartodb_id desc limit \".concat(limit, \" offset \").concat(offset);\n    fetch(\"\".concat(url, \"?q=\").concat(encodeURIComponent(query))).then(function (resp) {\n      resp.json().then(function (respData) {\n        var dataColumns = Object.keys(respData.rows[0]).map(function (x) {\n          return x;\n        });\n        setColumns(dataColumns);\n        setData(respData.rows);\n        var csvHeaders = dataColumns.join(\"|\");\n        var csvBody = respData.rows.map(function (rd) {\n          return Object.values(rd).map(function (i, k) {\n            return i;\n          }).join(\"|\");\n        }).map(function (x) {\n          return \"\\\"\".concat(x.replace(/(\\r\\n)+/g, \"\"), \"\\\"\\n\");\n        });\n        setCsvData(\"\".concat(csvHeaders, \"\\n\").concat(csvBody.join(\"\")));\n      });\n    });\n  };\n\n  var submitQuery = function submitQuery() {\n    var url = new URL(\"https://phl.carto.com/api/v2/sql\");\n    fetch(\"\".concat(url, \"?q=\").concat(encodeURIComponent(rawQuery))).then(function (resp) {\n      resp.json().then(function (respData) {\n        var dataColumns = Object.keys(respData.rows[0]).map(function (x) {\n          return x;\n        });\n        setColumns(dataColumns);\n        setData(respData.rows);\n        var csvHeaders = dataColumns.join(\"|\");\n        var csvBody = respData.rows.map(function (rd) {\n          return Object.values(rd).map(function (i, k) {\n            return i;\n          }).join(\"|\");\n        }).map(function (x) {\n          return \"\\\"\".concat(x.replace(/(\\r\\n)+/g, \"\"), \"\\\"\\n\");\n        });\n        setCsvData(\"\".concat(csvHeaders, \"\\n\").concat(csvBody.join(\"\")));\n      });\n    });\n  };\n\n  var styles = {\n    tableContainer: {\n      display: \"flex\",\n      width: \"100%\",\n      overflow: \"auto\",\n      height: \"720px\",\n      flexDirection: \"column\"\n    },\n    searchContainer: {\n      display: \"flex\",\n      flexDirection: \"column\",\n      flex: \"1\",\n      flexGrow: \"1\"\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: styles.searchContainer,\n      children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n        style: {\n          width: \"100%\",\n          padding: \"8px\",\n          margin: \"12px\"\n        },\n        value: rawQuery,\n        onChange: function onChange(e) {\n          return setRawQuery(e.target.value);\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: function onClick() {\n          return submitQuery();\n        },\n        children: \"Run Query\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 9\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Results\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 9\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: styles.tableContainer,\n      children: /*#__PURE__*/_jsxDEV(\"table\", {\n        style: {\n          paddingTop: \"24px\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n          children: /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: columns.map(function (col, idx) {\n              return /*#__PURE__*/_jsxDEV(\"th\", {\n                children: col\n              }, idx, false, {\n                fileName: _jsxFileName,\n                lineNumber: 101,\n                columnNumber: 24\n              }, _this);\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 99,\n            columnNumber: 13\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 11\n        }, _this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n          children: data.map(function (row, idx) {\n            return /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: Object.values(row).map(function (key, value) {\n                return /*#__PURE__*/_jsxDEV(\"td\", {\n                  children: key\n                }, value, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 110,\n                  columnNumber: 28\n                }, _this);\n              })\n            }, idx, false, {\n              fileName: _jsxFileName,\n              lineNumber: 108,\n              columnNumber: 17\n            }, _this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 11\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 9\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 7\n    }, _this)]\n  }, void 0, true);\n};\n\n_s(PermitTable, \"bh4DKZ8Z3YFBwnpgoNhnYdrTYrs=\");\n\n_c = PermitTable;\nexport default PermitTable;\n\nvar _c;\n\n$RefreshReg$(_c, \"PermitTable\");","map":{"version":3,"sources":["/Users/JDSCHRAC/projects/git/jdschrack/philly_permits/src/PermitTable.jsx"],"names":["useEffect","useState","PermitTable","limit","setLimit","offset","setOffset","rawQuery","setRawQuery","nextPage","getData","prevPage","columns","setColumns","recordCount","setRecordCount","data","setData","csvData","setCsvData","url","URL","query","fetch","encodeURIComponent","then","resp","json","respData","dataColumns","Object","keys","rows","map","x","csvHeaders","join","csvBody","rd","values","i","k","replace","submitQuery","styles","tableContainer","display","width","overflow","height","flexDirection","searchContainer","flex","flexGrow","padding","margin","e","target","value","paddingTop","col","idx","row","key"],"mappings":"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","sourcesContent":["import { useEffect, useState } from \"react\";\n\nconst PermitTable = () => {\n  const [limit, setLimit] = useState(1000);\n  const [offset, setOffset] = useState(0);\n  const [rawQuery, setRawQuery] = useState(\"\");\n  const nextPage = () => {\n    setOffset(offset + limit);\n    getData();\n  };\n\n  const prevPage = () => {\n    if (offset !== 0) {\n      setOffset(offset - limit);\n      getData();\n    }\n  };\n\n  const [columns, setColumns] = useState([]);\n  const [recordCount, setRecordCount] = useState(0);\n  const [data, setData] = useState([]);\n  const [csvData, setCsvData] = useState(\"\");\n  const getData = () => {\n    let url = new URL(\"https://phl.carto.com/api/v2/sql\");\n\n    let query = `select * from permits order by cartodb_id desc limit ${limit} offset ${offset}`;\n\n    fetch(`${url}?q=${encodeURIComponent(query)}`).then((resp) => {\n      resp.json().then((respData) => {\n        let dataColumns = Object.keys(respData.rows[0]).map((x) => x);\n        setColumns(dataColumns);\n        setData(respData.rows);\n        let csvHeaders = dataColumns.join(\"|\");\n        let csvBody = respData.rows\n          .map((rd) =>\n            Object.values(rd)\n              .map((i, k) => i)\n              .join(\"|\")\n          )\n          .map((x) => `\"${x.replace(/(\\r\\n)+/g, \"\")}\"\\n`);\n        setCsvData(`${csvHeaders}\\n${csvBody.join(\"\")}`);\n      });\n    });\n  };\n\n  const submitQuery = () => {\n    let url = new URL(\"https://phl.carto.com/api/v2/sql\");\n\n    fetch(`${url}?q=${encodeURIComponent(rawQuery)}`).then((resp) => {\n      resp.json().then((respData) => {\n        let dataColumns = Object.keys(respData.rows[0]).map((x) => x);\n        setColumns(dataColumns);\n        setData(respData.rows);\n        let csvHeaders = dataColumns.join(\"|\");\n        let csvBody = respData.rows\n          .map((rd) =>\n            Object.values(rd)\n              .map((i, k) => i)\n              .join(\"|\")\n          )\n          .map((x) => `\"${x.replace(/(\\r\\n)+/g, \"\")}\"\\n`);\n        setCsvData(`${csvHeaders}\\n${csvBody.join(\"\")}`);\n      });\n    });\n  };\n\n  const styles = {\n    tableContainer: {\n      display: \"flex\",\n      width: \"100%\",\n      overflow: \"auto\",\n      height: \"720px\",\n      flexDirection: \"column\",\n    },\n    searchContainer: {\n      display: \"flex\",\n      flexDirection: \"column\",\n      flex: \"1\",\n      flexGrow: \"1\",\n    },\n  };\n\n  return (\n    <>\n      <div style={styles.searchContainer}>\n        <textarea\n          style={{ width: \"100%\", padding: \"8px\", margin: \"12px\" }}\n          value={rawQuery}\n          onChange={(e) => setRawQuery(e.target.value)}\n        ></textarea>\n        <button onClick={() => submitQuery()}>Run Query</button>\n      </div>\n      <div>\n        <h3>Results</h3>\n      </div>\n      <div style={styles.tableContainer}>\n        <table style={{ paddingTop: \"24px\" }}>\n          <thead>\n            <tr>\n              {columns.map((col, idx) => {\n                return <th key={idx}>{col}</th>;\n              })}\n            </tr>\n          </thead>\n          <tbody>\n            {data.map((row, idx) => {\n              return (\n                <tr key={idx}>\n                  {Object.values(row).map((key, value) => {\n                    return <td key={value}>{key}</td>;\n                  })}\n                </tr>\n              );\n            })}\n          </tbody>\n        </table>\n      </div>\n    </>\n  );\n};\n\nexport default PermitTable;\n"]},"metadata":{},"sourceType":"module"}